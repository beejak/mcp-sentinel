# Example Reports

This directory contains sample security scan reports generated by MCP Sentinel. These examples demonstrate the quality and detail of vulnerability reports you can expect when scanning your codebase.

## Available Report Formats

### 1. HTML Report ([example-report.html](reports/example-report.html))

**Best for:** Executive summaries, security reviews, sharing with stakeholders

**Features:**
- Interactive executive dashboard
- Risk scoring (0-100 scale)
- Severity breakdown with color-coded charts
- Detailed vulnerability cards with:
  - File path and line number
  - Code snippets with syntax highlighting
  - Remediation guidance
  - CWE/CVSS information
  - Engine detection source
- Responsive design for mobile/tablet
- Animated charts and graphs
- Professional styling

**How to view:** Open directly in any web browser

### 2. SARIF Report ([example-report.sarif](reports/example-report.sarif))

**Best for:** GitHub Code Scanning, IDE integration, automation

**Features:**
- SARIF 2.1.0 compliant format
- GitHub Security tab compatible
- Structured JSON for programmatic analysis
- Includes:
  - Vulnerability locations with regions
  - Severity levels (error, warning, note)
  - CWE mappings
  - Rule metadata
  - Fix suggestions
- Tool driver information
- Results grouping by rule ID

**How to use:**
```bash
# Upload to GitHub Security tab
gh api repos/:owner/:repo/code-scanning/sarifs \
  -F sarif=@example-report.sarif \
  -F commit_sha=$(git rev-parse HEAD) \
  -F ref=refs/heads/main
```

### 3. JSON Report ([example-report.json](reports/example-report.json))

**Best for:** Custom tooling, data analysis, CI/CD pipelines

**Features:**
- Complete scan result data structure
- Easy to parse and query
- Includes:
  - All vulnerabilities with full metadata
  - Scan statistics (files scanned, duration, counts)
  - Severity breakdown
  - Engine attribution
  - Timestamps and version info
- Machine-readable format
- Can be consumed by custom dashboards

**How to use:**
```python
import json

with open("example-report.json") as f:
    report = json.load(f)

# Get critical vulnerabilities only
critical = [v for v in report["vulnerabilities"]
            if v["severity"] == "critical"]

print(f"Found {len(critical)} critical issues")
```

## What's in These Examples?

These reports were generated by scanning the `tests/fixtures/` directory, which contains intentionally vulnerable code samples for testing purposes. The reports showcase:

### Vulnerability Categories Detected:
1. **Hardcoded Secrets** - API keys, AWS credentials, passwords
2. **Code Injection** - SQL injection, command injection, eval abuse
3. **Prompt Injection** - AI manipulation attacks
4. **XSS Vulnerabilities** - DOM XSS, event handlers
5. **Configuration Issues** - Weak crypto, debug mode enabled
6. **Path Traversal** - Directory traversal attacks
7. **Tool Poisoning** - Unicode manipulation
8. **Supply Chain** - Malicious package detection

### Severity Levels:
- **CRITICAL** - Requires immediate attention, exploitable vulnerabilities
- **HIGH** - Significant security risks, should be fixed soon
- **MEDIUM** - Important issues that reduce security posture
- **LOW** - Minor issues or best practice violations
- **INFO** - Informational findings, no immediate risk

## Generating Your Own Reports

### Quick Start

Scan your project and generate all formats:

```bash
# HTML report (interactive dashboard)
mcp-sentinel scan . --output html --json-file my-report.html

# SARIF report (GitHub Code Scanning)
mcp-sentinel scan . --output sarif --json-file my-report.sarif

# JSON report (automation)
mcp-sentinel scan . --output json --json-file my-report.json
```

### Multi-Engine Scan

Use all 4 analysis engines for maximum coverage:

```bash
mcp-sentinel scan . --engines all --output html --json-file full-scan.html
```

**4 Engines:**
1. **Static** - Pattern-based detection (fast, 1-2s)
2. **SAST** - Semgrep + Bandit (thorough, 5-10s)
3. **Semantic** - AST taint tracking (accurate, 10-30s)
4. **AI** - Claude 3.5 Sonnet (comprehensive, 30-60s, requires API key)

### Filter by Severity

Show only critical and high severity issues:

```bash
mcp-sentinel scan . \
  --severity critical --severity high \
  --output html \
  --json-file critical-issues.html
```

### CI/CD Integration

For continuous integration pipelines:

```bash
# Generate SARIF for GitHub Actions
mcp-sentinel scan . --engines static,sast --output sarif --json-file results.sarif

# Exit code 1 if critical findings (fails the build)
```

## Report Statistics

These example reports contain findings from scanning ~20 test files with known vulnerabilities:

| Metric | Value |
|--------|-------|
| Files Scanned | ~20 Python files |
| Scan Duration | ~2-5 seconds |
| Total Vulnerabilities | 50+ findings |
| Engines Used | Static Analysis |
| Critical Findings | 10+ |
| High Findings | 15+ |
| Medium Findings | 20+ |
| Risk Score | 75-85/100 (High Risk) |

**Note:** These are test fixtures with intentionally vulnerable code. Real projects typically have lower finding counts!

## Customizing Reports

### Configuration File

Create `.mcp-sentinel.yaml` to customize report generation:

```yaml
reporting:
  formats: [terminal, html, sarif]
  output_dir: ./security-reports

  html:
    include_executive_summary: true
    show_risk_score: true
    animated_charts: true
    multi_engine_comparison: true

  sarif:
    github_code_scanning: true
    include_fixes: true
```

### Programmatic Report Generation

Use MCP Sentinel as a library for custom reporting:

```python
from mcp_sentinel.core.multi_engine_scanner import MultiEngineScanner
from mcp_sentinel.engines.base import EngineType
from mcp_sentinel.reporting.generators import HTMLGenerator

# Scan with multiple engines
scanner = MultiEngineScanner(
    enabled_engines={EngineType.STATIC, EngineType.SAST}
)
result = await scanner.scan_directory("/path/to/project")

# Generate custom report
generator = HTMLGenerator()
generator.save_to_file(result, Path("custom-report.html"))
```

## Questions or Issues?

- **Documentation**: [README.md](../README.md)
- **Quick Start**: [QUICKSTART.md](../QUICKSTART.md)
- **Architecture**: [ARCHITECTURE.md](../docs/ARCHITECTURE.md)
- **Issues**: [GitHub Issues](https://github.com/beejak/mcp-sentinel/issues)

---

**Tip:** Open the HTML report in a browser to see the full interactive experience with charts, filtering, and detailed vulnerability cards!
